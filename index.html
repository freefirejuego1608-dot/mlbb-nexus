<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MLBB Nexus PRO | Modern Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* Estilos Base y Variables Globales */
        * { margin:0; padding:0; box-sizing:border-box; }
        :root {
            /* Tema Oscuro (Defecto) */
            --primary-color: #ff6b00; 
            --secondary-color: #ffb400;
            --bg-color: #000;
            --text-color: #fff;
            --card-bg: rgba(30,30,30,0.9);
            --header-bg: rgba(0,0,0,0.95);
            --border-color: rgba(255,107,0,0.3);
            --favorite-color: #ffd700;
            --bar-color: var(--secondary-color);
            --transition-duration: 0.4s;
        }

        /* Tema Claro (Activado por la clase .light-mode) - Idea 2 */
        .light-mode {
            --primary-color: #006bff; /* Azul */
            --secondary-color: #00b4ff; /* Azul claro */
            --bg-color: #f0f0f5;
            --text-color: #111;
            --card-bg: rgba(255,255,255,0.95);
            --header-bg: rgba(255,255,255,0.95);
            --border-color: rgba(0,107,255,0.3);
            --bar-color: var(--secondary-color);
        }

        body {
            font-family: 'Orbitron', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            padding-bottom: 90px;
            overflow-x: hidden;
            background-image: radial-gradient(#222 1px, transparent 0), radial-gradient(#222 1px, transparent 0);
            background-size: 50px 50px;
            background-position: 0 0, 25px 25px;
            background-attachment: fixed; 
            transition: background-color 0.5s ease, color 0.5s ease; /* Transici√≥n para modo oscuro */
        }
        .light-mode body {
            background-image: radial-gradient(#ccc 1px, transparent 0), radial-gradient(#ccc 1px, transparent 0);
        }

        /* ------------------ Header and Title ------------------ */
        header {
            text-align: center;
            padding: 25px 20px 15px;
            background: var(--header-bg);
            backdrop-filter: blur(5px);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 2px solid var(--border-color);
        }
        h1 {
            font-size: 2.6rem;
            font-weight: 900;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255,107,0,0.8);
            animation: glow 2s infinite alternate;
        }
        .light-mode h1 { text-shadow: none; }
        @keyframes glow { 
            from { text-shadow: 0 0 20px rgba(255,107,0,0.8); } 
            to { text-shadow: 0 0 40px rgba(255,107,0,1); } 
        }

        /* Bot√≥n de Notificaci√≥n (Idea 5) */
        .notification-bell {
            position: absolute;
            top: 25px;
            right: 20px;
            font-size: 28px;
            cursor: pointer;
            color: var(--secondary-color);
            transition: transform 0.2s;
        }
        .notification-bell:hover { transform: rotate(10deg) scale(1.1); }
        .notification-badge {
            position: absolute;
            top: 25px;
            right: 18px;
            width: 10px;
            height: 10px;
            background: red;
            border-radius: 50%;
            border: 2px solid var(--header-bg);
            animation: mini-pulse 1s infinite;
        }
        @keyframes mini-pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }
        /* Contenedor de Alerta */
        .alert-popover {
            position: absolute;
            top: 60px;
            right: 10px;
            background: var(--card-bg);
            border: 1px solid var(--primary-color);
            border-radius: 8px;
            padding: 15px;
            width: 250px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
            z-index: 150;
            display: none;
            animation: fadeIn 0.3s;
        }

        /* ------------------ Search Box and Tabs ------------------ */
        .search-box input {
            border: 2px solid var(--primary-color);
            background: var(--card-bg);
            color: var(--text-color);
            box-shadow: 0 0 20px rgba(255,107,0,0.4);
        }
        .search-box input:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 30px rgba(255,180,0,0.7);
        }
        .search-box::after { color: var(--primary-color); }
        .tab.active { animation: fadeIn var(--transition-duration) ease-out forwards; }
        @keyframes fadeIn { 
            from { opacity:0; transform:translateY(20px); } 
            to { opacity:1; transform:translateY(0); } 
        }

        /* ------------------ Hero Grid and Cards ------------------ */
        .hero-card {
            background: var(--card-bg);
        }
        .hero-card:hover { 
            box-shadow: 0 15px 35px rgba(255,107,0,0.6);
            background: rgba(45,45,45,0.9);
        }
        .hero-img {
            box-shadow: 0 0 10px var(--primary-color), inset 0 0 10px var(--secondary-color);
            animation: hologramGlow 4s infinite alternate;
        }
        .hero-card:hover .hero-img {
            box-shadow: 0 0 25px var(--secondary-color), inset 0 0 15px var(--primary-color);
        }
        
        /* ------------------ Modal de H√©roe ------------------ */
        .modal-subnav {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
            border-bottom: 1px solid #333;
        }
        .modal-subnav-item {
            padding: 8px 15px;
            cursor: pointer;
            color: #888;
            transition: color 0.3s, border-bottom 0.3s;
        }
        .modal-subnav-item.active {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            font-weight: bold;
        }
        .modal-tab-content {
            display: none;
            animation: fadeIn 0.4s;
        }
        .modal-tab-content.active {
            display: block;
        }
        .detail-title { color: var(--primary-color); }
        .build-item { background: #333; color: #fff; }

        /* ------------------ Gr√°ficos Din√°micos (Idea 1) ------------------ */
        .chart-container {
            padding: 10px 0;
        }
        .chart-row {
            margin-bottom: 15px;
            font-size: 13px;
        }
        .chart-label {
            margin-bottom: 5px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
        }
        .chart-bar-container {
            height: 15px;
            background: #222;
            border-radius: 5px;
            overflow: hidden;
        }
        .chart-bar {
            height: 100%;
            background: linear-gradient(90deg, #444, var(--bar-color));
            border-radius: 5px;
            transition: width 1s ease-out; /* Animaci√≥n de crecimiento */
            width: 0%; /* Inicia en cero para la animaci√≥n */
        }
        .light-mode .chart-bar-container { background: #e0e0e0; }
        .light-mode .chart-bar { background: linear-gradient(90deg, #aaa, var(--bar-color)); }

        /* ------------------ Navegaci√≥n Inferior ------------------ */
        .nav {
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(15px);
            border-top: 1px solid rgba(255,107,0,0.2);
        }
        .light-mode .nav {
            background: rgba(255,255,255,0.7);
            border-top: 1px solid rgba(0,0,0,0.1);
        }
        .nav-item.active {
            background: rgba(255,107,0,0.3);
            color: var(--primary-color);
            box-shadow: 0 0 10px rgba(255,107,0,0.5);
        }

        /* Alternador de Tema (Idea 2) */
        .theme-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 30px 0;
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
            margin: 0 15px;
        }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #333;
            transition: 0.4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "üåë";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: var(--secondary-color);
            transition: 0.4s;
            border-radius: 50%;
            text-align: center;
            line-height: 26px;
        }
        input:checked + .slider {
            background-color: var(--primary-color);
        }
        input:checked + .slider:before {
            transform: translateX(26px);
            content: "‚òÄÔ∏è";
        }
    </style>
</head>
<body class="dark-mode"> <header>
    <h1>MLBB Nexus PRO</h1>
    <span class="notification-bell" id="notification-bell">üîî</span>
    <span class="notification-badge" id="notification-badge"></span>
    <div class="alert-popover" id="alert-popover">
        <h4 style="color:var(--primary-color); margin-bottom:5px;">¬°Alerta de Parche!</h4>
        <p style="font-size:12px;">Se ha publicado el Patch 1.9.90. ¬°Nerf masivo a Fanny y Buff a Layla!</p>
    </div>
    <div class="search-box">
        <input type="text" id="search" placeholder="Buscar h√©roe...">
    </div>
</header>

<div class="tab active" id="heroes-tab">
    <div style="text-align:center; padding: 10px 20px;">
        <div id="all-heroes-filter" class="lane-btn active" style="margin-right: 15px;">Todos los H√©roes</div>
        <div id="favorites-filter" class="lane-btn" style="margin-right: 15px;">Mis Favoritos ‚≠ê</div>
    </div>
    <div class="heroes-grid" id="heroes-grid"></div>
</div>

<div class="tab" id="ranking-tab">
    <div class="lanes" id="lane-buttons">
        <div class="lane-btn active" data-lane="gold">ü™ô Gold Lane</div>
        <div class="lane-btn" data-lane="exp">‚öîÔ∏è EXP Lane</div>
        <div class="lane-btn" data-lane="jungle">üå≥ Jungla</div>
        <div class="lane-btn" data-lane="mid">üîÆ Mid Lane</div>
        <div class="lane-btn" data-lane="roam">üõ°Ô∏è Roam</div>
    </div>
    <div id="tier-container"></div>
</div>

<div class="tab" id="more-tab">
    <div class="download-section">
        <h2 style="color:var(--primary-color); margin-bottom:20px;">‚ö° ¬°Configuraci√≥n y Utilidades! ‚ö°</h2>
        
        <div class="theme-toggle">
            <span style="font-size: 14px;">Modo Oscuro</span>
            <label class="toggle-switch">
                <input type="checkbox" id="theme-toggle-switch">
                <span class="slider"></span>
            </label>
            <span style="font-size: 14px;">Modo Claro</span>
        </div>

        <p style="margin-bottom: 25px;">Pronto disponible con notificaciones y modo offline.</p>
        <button class="download-btn">Descargar MLBB Nexus PRO</button>
    </div>
</div>

<div id="heroModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <img id="heroDetailImg" class="hero-detail-img" src="" alt="Hero Portrait">
        
        <div class="modal-subnav">
            <div class="modal-subnav-item active" data-modal-tab="details">Detalles</div>
            <div class="modal-subnav-item" data-modal-tab="stats">Estad√≠sticas</div>
        </div>

        <div class="modal-tab-content active" id="modal-details">
            <div id="heroDetail"></div>
        </div>

        <div class="modal-tab-content" id="modal-stats">
            <div class="chart-container" id="heroStatsChart">
                </div>
        </div>
    </div>
</div>

<nav class="nav">
    <div class="nav-item active" data-tab="heroes-tab">
        <span>üë§</span><small>H√©roes</small>
    </div>
    <div class="nav-item" data-tab="ranking-tab">
        <span>üèÜ</span><small>Tier List</small>
    </div>
    <div class="nav-item" data-tab="more-tab">
        <span>‚ûï</span><small>M√°s</small>
    </div>
</nav>

<script>
// Base de datos de h√©roes (A√±adido 'id' y 'stats')
const heroes = [
    {id:1, name:"Miya",img:"https://static.wikia.nocookie.net/mobile-legends/images/3/3a/Portrait_Miya.png/revision/latest", description:"Marksman de da√±o sostenido, fuerte en late game para derretir tanks con su ultimate. Tier B en gold lane.", build:"Demon Hunter Sword, Wind of Nature, Haas's Claws, Blade of Despair, Rose Gold Meteor, Malefic Roar", strongAgainst:"Tanks y fighters con bajo sustain", counters:"Franco, Kaja, Hayabusa", lane:"gold", tier:"B", stats: {damage: 80, durability: 30, control: 40, difficulty: 60}},
    {id:2, name:"Balmond",img:"https://static.wikia.nocookie.net/mobile-legends/images/1/1b/Portrait_Balmond.png/revision/latest", description:"Fighter jungle/EXP con regen y AoE. Excelente clear y teamfight. Tier A en EXP.", build:"Bloodlust Axe, Endless Battle, Haas's Claws, Blade of Despair, Oracle, Brute Force Breastplate", strongAgainst:"Squishies y healers", counters:"Phoveus, Khufra, Baxia", lane:"exp", tier:"A", stats: {damage: 70, durability: 90, control: 60, difficulty: 40}},
    {id:3, name:"Saber",img:"https://static.wikia.nocookie.net/mobile-legends/images/5/5e/Portrait_Saber.png/revision/latest", description:"Assassin burst con charge. Buen pick off pero vulnerable a CC. Tier B en jungle.", build:"Magic Shoes, Starlium Scythe, Holy Crystal, Divine Glaive, Winter Truncheon, Immortality", strongAgainst:"Marksmen y mages solos", counters:"Franco, Chou, Kaja", lane:"jungle", tier:"B", stats: {damage: 95, durability: 20, control: 50, difficulty: 70}},
    {id:4, name:"Alice",img:"https://static.wikia.nocookie.net/mobile-legends/images/0/0d/Portrait_Alice.png/revision/latest", description:"Tank/Mage S-tier con sustain infinito y burst. Domina teamfights en meta 2025.", build:"Concentrated Energy, Oracle, Holy Crystal, Divine Glaive, Winter Truncheon, Immortality", strongAgainst:"Assassins y fighters", counters:"Phoveus, Minsitthar", lane:"mid", tier:"S", stats: {damage: 80, durability: 80, control: 90, difficulty: 65}},
    {id:5, name:"Nana",img:"https://static.wikia.nocookie.net/mobile-legends/images/2/2f/Portrait_Nana.png/revision/latest", description:"Mage poke con CC. Tier C en mid, √∫til para peel.", build:"Clock of Destiny, Lightning Truncheon, Holy Crystal, Divine Glaive, Genius Wand", strongAgainst:"Melee divers", counters:"Fanny, Ling", lane:"mid", tier:"C", stats: {damage: 60, durability: 40, control: 90, difficulty: 45}},
    {id:6, name:"Tigreal",img:"https://static.wikia.nocookie.net/mobile-legends/images/0/0e/Portrait_Tigreal.png/revision/latest", description:"Tank roam cl√°sico con CC fuerte. Tier B en roam para setups.", build:"Tough Boots, Dominance Ice, Athena's Shield, Immortality, Brute Force Breastplate", strongAgainst:"Grouped teams", counters:"Phoveus, Joy", lane:"roam", tier:"B", stats: {damage: 20, durability: 100, control: 100, difficulty: 50}},
    {id:7, name:"Franco",img:"https://static.wikia.nocookie.net/mobile-legends/images/4/4c/Portrait_Franco.png/revision/latest", description:"Tank roam S-tier para picks con hook. Domina picks off.", build:"Tough Boots, Dominance Ice, Athena's Shield, Immortality, Oracle", strongAgainst:"Assassins y MM", counters:"Joy, Ling (dodge hook)", lane:"roam", tier:"S", stats: {damage: 30, durability: 90, control: 100, difficulty: 70}},
    {id:8, name:"Clint",img:"https://static.wikia.nocookie.net/mobile-legends/images/8/8b/Portrait_Clint.png/revision/latest", description:"Marksman A-tier con true damage. Fuerte vs tanks.", build:"Swift Boots, Demon Hunter Sword, Haas's Claws, Malefic Roar", strongAgainst:"Armored heroes", counters:"Hayabusa, Saber", lane:"gold", tier:"A", stats: {damage: 90, durability: 35, control: 50, difficulty: 60}},
    {id:9, name:"Karina",img:"https://static.wikia.nocookie.net/mobile-legends/images/6/6b/Portrait_Karina.png/revision/latest", description:"Assassin anti-mage. Tier A en jungle contra comps m√°gicas.", build:"Magic Shoes, Starlium Scythe, Holy Crystal, Divine Glaive, Genius Wand", strongAgainst:"Mages y supports", counters:"Franco, Chou", lane:"jungle", tier:"A", stats: {damage: 95, durability: 40, control: 60, difficulty: 60}},
    {id:12, name:"Hayabusa",img:"https://static.wikia.nocookie.net/mobile-legends/images/3/3c/Portrait_Hayabusa.png/revision/latest", description:"Assassin S-tier jungle. Burst y mobility top meta 2025.", build:"Magic Shoes, Blade of the Heptaseas, Haas's Claws, Blade of Despair", strongAgainst:"Squishies", counters:"Franco, Kaja", lane:"jungle", tier:"S", stats: {damage: 90, durability: 30, control: 70, difficulty: 90}},
    {id:20, name:"Wanwan",img:"https://static.wikia.nocookie.net/mobile-legends/images/a/a1/Portrait_Wanwan.png/revision/latest", description:"Marksman hyper-mobile.", build:"Swift Boots, Demon Hunter Sword, Corrosion Scythe", strongAgainst:"Tanks", counters:"Franco, Chou", lane:"gold", tier:"S", stats: {damage: 85, durability: 30, control: 70, difficulty: 85}},
    {id:21, name:"Khufra",img:"https://static.wikia.nocookie.net/mobile-legends/images/6/6f/Portrait_Khufra.png/revision/latest", description:"Tank anti-dash.", build:"Tough Boots, Dominance Ice, Athena's Shield", strongAgainst:"Dash heroes", counters:"Diggie, Rafaela", lane:"roam", tier:"S", stats: {damage: 20, durability: 95, control: 100, difficulty: 60}},
];

const tierOrder = ["S", "A", "B", "C", "D"]; 
let isFavoriteView = false; 

// ------------------ Funcionalidad de Favoritos ------------------

function getFavorites() {
    const favorites = localStorage.getItem('mlbb_favorites');
    return favorites ? JSON.parse(favorites) : [];
}

function saveFavorites(favorites) {
    localStorage.setItem('mlbb_favorites', JSON.stringify(favorites));
}

function toggleFavorite(heroId, event) {
    event.stopPropagation();
    const id = parseInt(heroId);
    let favorites = getFavorites();
    const isCurrentlyFavorite = favorites.includes(id);

    if (isCurrentlyFavorite) {
        favorites = favorites.filter(favId => favId !== id);
    } else {
        favorites.push(id);
    }

    saveFavorites(favorites);
    
    // Rerenderizar la grid para actualizar el icono y la lista
    renderHeroes(document.getElementById('search').value, isFavoriteView);
}

// ------------------ Funcionalidad de Gr√°ficos (Idea 1) ------------------

function renderHeroStats(hero) {
    const chartContainer = document.getElementById('heroStatsChart');
    chartContainer.innerHTML = '';

    const statsMap = {
        damage: 'Da√±o',
        durability: 'Durabilidad',
        control: 'Control',
        difficulty: 'Dificultad'
    };

    let html = '';
    for (const key in hero.stats) {
        if (hero.stats.hasOwnProperty(key)) {
            const value = hero.stats[key]; // Valor de 0 a 100
            const label = statsMap[key] || key;
            html += `
                <div class="chart-row">
                    <div class="chart-label">
                        <span>${label}</span>
                        <span>${value}%</span>
                    </div>
                    <div class="chart-bar-container">
                        <div class="chart-bar" style="width: ${value}%;"></div>
                    </div>
                </div>
            `;
        }
    }
    chartContainer.innerHTML = html;
}


// ------------------ Funcionalidad Principal ------------------

function renderHeroes(filterText = '', onlyFavorites = false) {
    const grid = document.getElementById('heroes-grid');
    grid.innerHTML = '';
    
    let filtered = heroes;
    
    if (onlyFavorites) {
        const favoriteIds = getFavorites();
        filtered = filtered.filter(hero => favoriteIds.includes(hero.id));
    }
    
    filtered = filtered.filter(hero => hero.name.toLowerCase().includes(filterText.toLowerCase()));

    const favoriteIds = getFavorites();

    if (filtered.length === 0) {
        grid.innerHTML = `<p style="text-align:center; color:#888; padding:30px;">No se encontraron h√©roes${onlyFavorites ? ' en tus favoritos.' : '.'}</p>`;
        return;
    }

    filtered.forEach(hero => {
        const isFav = favoriteIds.includes(hero.id);
        
        const card = document.createElement('div');
        card.className = 'hero-card';
        card.setAttribute('onclick', `openModal('${hero.name}')`);
        card.innerHTML = `
            <span class="favorite-btn ${isFav ? 'active' : ''}" onclick="toggleFavorite(${hero.id}, event)">${isFav ? '‚≠ê' : '‚òÜ'}</span>
            <img class="hero-img" src="${hero.img}" alt="${hero.name}">
            <p class="hero-name">${hero.name}</p>
        `;
        grid.appendChild(card);
    });
}

function renderTierList(lane) {
    const container = document.getElementById('tier-container');
    
    // Mostrar Skeleton Loader
    container.innerHTML = createSkeletonLoader();

    setTimeout(() => {
        container.innerHTML = '';
        const filteredByLane = heroes.filter(hero => hero.lane === lane);

        tierOrder.forEach(tier => {
            const heroesInTier = filteredByLane.filter(hero => hero.tier === tier);
            if (heroesInTier.length > 0) {
                const section = document.createElement('div');
                section.className = 'tier-section';
                section.innerHTML = `
                    <div class="tier-row">
                        <h3 class="tier-title">Tier ${tier}</h3>
                        <div class="tier-grid">
                            ${heroesInTier.map(hero => `
                                <div class="tier-hero" onclick="openModal('${hero.name}')">
                                    <img src="${hero.img}" alt="${hero.name}">
                                    <p>${hero.name}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                container.appendChild(section);
            }
        });
    }, 500); // 500ms de retraso simulado
}

function createSkeletonLoader() {
    let loader = '<div class="skeleton-loader">';
    for (let i = 0; i < 3; i++) { 
        loader += `
            <div class="skeleton-row">
                <div class="skeleton-title"></div>
                <div class="skeleton-grid">
                    <div class="skeleton-item"></div>
                    <div class="skeleton-item"></div>
                    <div class="skeleton-item"></div>
                    <div class="skeleton-item" style="display: none;"></div>
                </div>
            </div>
        `;
    }
    loader += '</div>';
    return loader;
}

// ------------------ Funcionalidad de Interacci√≥n ------------------

function openModal(heroName) {
    const hero = heroes.find(h => h.name === heroName);
    if (!hero) return;

    // Reiniciar a la pesta√±a de "Detalles" al abrir
    document.querySelector('.modal-subnav-item.active').classList.remove('active');
    document.querySelector('[data-modal-tab="details"]').classList.add('active');
    document.querySelectorAll('.modal-tab-content').forEach(c => c.classList.remove('active'));
    document.getElementById('modal-details').classList.add('active');


    document.getElementById('heroDetailImg').src = hero.img;
    document.getElementById('heroDetail').innerHTML = `
        <h2 style="color:var(--secondary-color); text-align:center; margin-bottom:15px; font-size: 28px;">${hero.name}</h2>
        <p class="detail-text"><strong>Rol/Lane:</strong> ${hero.lane} (${hero.tier}-Tier)</p>
        <p class="detail-text">${hero.description}</p>
        
        <h3 class="detail-title">‚öôÔ∏è Build Recomendada</h3>
        <div class="build-list">
            ${hero.build.split(', ').map(item => `<span class="build-item">${item}</span>`).join('')}
        </div>

        <h3 class="detail-title">üëç Fuerte Contra</h3>
        <p class="detail-text">${hero.strongAgainst}</p>

        <h3 class="detail-title">üëé Counters</h3>
        <p class="detail-text">${hero.counters}</p>
    `;

    // Renderizar los gr√°ficos inmediatamente para el h√©roe
    renderHeroStats(hero);

    document.getElementById('heroModal').classList.add('active');
}

function closeModal() {
    document.getElementById('heroModal').classList.remove('active');
}

function switchModalTab(tabId) {
    document.querySelectorAll('.modal-subnav-item').forEach(item => item.classList.remove('active'));
    document.querySelectorAll('.modal-tab-content').forEach(content => content.classList.remove('active'));

    document.querySelector(`[data-modal-tab="${tabId}"]`).classList.add('active');
    document.getElementById(`modal-${tabId}`).classList.add('active');
}

// ------------------ Funcionalidad de Tema (Idea 2) ------------------

function toggleTheme(event) {
    const body = document.body;
    if (event.target.checked) {
        body.classList.remove('dark-mode');
        body.classList.add('light-mode');
        localStorage.setItem('mlbb_theme', 'light');
    } else {
        body.classList.remove('light-mode');
        body.classList.add('dark-mode');
        localStorage.setItem('mlbb_theme', 'dark');
    }
}

// ------------------ Funcionalidad de Notificaciones (Idea 5) ------------------

function toggleNotificationPopover() {
    const popover = document.getElementById('alert-popover');
    const badge = document.getElementById('notification-badge');

    if (popover.style.display === 'block') {
        popover.style.display = 'none';
    } else {
        popover.style.display = 'block';
        // Simular que la notificaci√≥n se lee al abrir
        badge.style.display = 'none';
    }
}


// ------------------ Event Listeners ------------------

document.addEventListener('DOMContentLoaded', () => {
    // Inicializar el tema basado en localStorage
    const savedTheme = localStorage.getItem('mlbb_theme') || 'dark';
    const themeToggle = document.getElementById('theme-toggle-switch');
    if (savedTheme === 'light') {
        document.body.classList.add('light-mode');
        themeToggle.checked = true;
    } else {
        document.body.classList.add('dark-mode');
        themeToggle.checked = false;
    }

    // Inicializar la grid de h√©roes (muestra todos por defecto)
    isFavoriteView = false;
    renderHeroes('', isFavoriteView);

    // Manejar la b√∫squeda
    document.getElementById('search').addEventListener('input', (e) => {
        renderHeroes(e.target.value, isFavoriteView);
    });

    // Manejar el cambio de tabs de la navegaci√≥n principal (c√≥digo existente)
    document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', (e) => {
            const tabId = item.getAttribute('data-tab');
            switchTab(tabId);
        });
    });

    // Manejar el cambio de lane en la Tier List (c√≥digo existente)
    document.querySelectorAll('.lane-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            document.querySelectorAll('.lane-btn').forEach(el => el.classList.remove('active'));
            e.target.classList.add('active');
            renderTierList(e.target.getAttribute('data-lane'));
        });
    });

    // Manejar el filtro de Favoritos (c√≥digo existente)
    document.getElementById('all-heroes-filter').addEventListener('click', (e) => {
        isFavoriteView = false;
        document.getElementById('favorites-filter').classList.remove('active');
        e.target.classList.add('active');
        renderHeroes(document.getElementById('search').value, isFavoriteView);
    });

    document.getElementById('favorites-filter').addEventListener('click', (e) => {
        isFavoriteView = true;
        document.getElementById('all-heroes-filter').classList.remove('active');
        e.target.classList.add('active');
        renderHeroes(document.getElementById('search').value, isFavoriteView);
    });
    
    // Event listener para el toggle de tema (Idea 2)
    themeToggle.addEventListener('change', toggleTheme);

    // Event listener para el sub-navegador del modal (Idea 1)
    document.querySelectorAll('.modal-subnav-item').forEach(item => {
        item.addEventListener('click', (e) => {
            switchModalTab(e.target.getAttribute('data-modal-tab'));
        });
    });

    // Event listener para el bot√≥n de notificaci√≥n (Idea 5)
    document.getElementById('notification-bell').addEventListener('click', toggleNotificationPopover);
    
    // Cargar la Tier List inicial (Gold Lane)
    renderTierList('gold');
});

// Switch Tab (funci√≥n global necesaria para el nav)
function switchTab(tabId) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    document.getElementById(tabId).classList.add('active');
    document.querySelector(`.nav-item[data-tab="${tabId}"]`).classList.add('active');

    if (tabId === 'ranking-tab') {
        const activeLane = document.querySelector('.lanes .lane-btn.active').getAttribute('data-lane');
        renderTierList(activeLane);
    }
    
    if (tabId === 'heroes-tab') {
        renderHeroes(document.getElementById('search').value, isFavoriteView);
    }
}

// Cerrar modal al hacer clic fuera de √©l
window.onclick = function(event) {
    const modal = document.getElementById('heroModal');
    const popover = document.getElementById('alert-popover');
    if (event.target == modal) {
        closeModal();
    }
    // Cerrar popover si se hace clic fuera de la campana
    if (event.target !== document.getElementById('notification-bell') && event.target !== popover) {
        popover.style.display = 'none';
    }
}
</script>
</body>
</html>
