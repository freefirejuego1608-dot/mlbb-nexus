<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Flappy Bird Mobile</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { 
      background: #000; 
      overflow: hidden; 
      touch-action: manipulation;
      font-family: Arial, sans-serif;
    }
    canvas { 
      display: block; 
      margin: 0 auto;
      image-rendering: pixelated; /* look retro */
    }
    #startScreen, #gameOverScreen {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.7);
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 2.5em;
      text-align: center;
      z-index: 10;
    }
    #gameOverScreen div {
      margin: 20px;
    }
    button {
      margin-top: 30px;
      padding: 15px 30px;
      font-size: 1.2em;
      background: #ffcc00;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    .medal {
      font-size: 4em;
      margin: 20px;
    }
  </style>
</head>
<body>
  <div id="startScreen">
    <h1>FLAPPY BIRD</h1>
    <p>Toca la pantalla para volar</p>
    <button onclick="startGame()">JUGAR</button>
  </div>

  <div id="gameOverScreen" style="display:none;">
    <h1>隆Game Over!</h1>
    <div>Puntuaci贸n: <span id="finalScore">0</span></div>
    <div class="medal">
      <span id="medal"></span>
    </div>
    <button onclick="restartGame()">Jugar de nuevo</button>
  </div>

  <canvas id="canvas"></canvas>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    
    // Adaptar al tama帽o de pantalla (m贸vil)
    function resize() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    resize();
    window.addEventListener('resize', resize);

    // Variables del juego
    let bird = {
      x: canvas.width / 4,
      y: canvas.height / 2,
      size: Math.min(canvas.width, canvas.height) * 0.08,
      velocity: 0,
      gravity: 0.5,
      jump: -10,
      alive: true
    };

    let pipes = [];
    let score = 0;
    let frame = 0;
    let gameStarted = false;

    // Generar tubos
    function spawnPipe() {
      const minHeight = 50;
      const maxHeight = canvas.height - 200;
      const height = Math.floor(Math.random() * (maxHeight - minHeight + 1)) + minHeight;
      const gap = 140;

      pipes.push({
        x: canvas.width,
        top: height,
        bottom: height + gap,
        passed: false
      });
    }

    // Reiniciar juego
    function resetGame() {
      bird.y = canvas.height / 2;
      bird.velocity = 0;
      bird.alive = true;
      pipes = [];
      score = 0;
      frame = 0;
      document.getElementById('gameOverScreen').style.display = 'none';
    }

    function startGame() {
      document.getElementById('startScreen').style.display = 'none';
      resetGame();
      gameStarted = true;
      spawnPipe();
      requestAnimationFrame(gameLoop);
    }

    function restartGame() {
      startGame();
    }

    // Input t谩ctil y clic
    function flap() {
      if (bird.alive && gameStarted) {
        bird.velocity = bird.jump;
      }
    }
    canvas.addEventListener('touchstart', flap);
    canvas.addEventListener('click', flap);

    // Bucle principal
    function gameLoop() {
      if (!gameStarted) return;

      // Fondo
      ctx.fillStyle = '#4ec0ca';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Suelo
      ctx.fillStyle = '#8bce5e';
      ctx.fillRect(0, canvas.height - 50, canvas.width, 50);

      // Actualizar p谩jaro
      if (bird.alive) {
        bird.velocity += bird.gravity;
        bird.y += bird.velocity;

        // Rotaci贸n del p谩jaro
        bird.rotation = Math.min(Math.max(bird.velocity * 3, -30), 90);
      }

      // Dibujar p谩jaro
      ctx.save();
      ctx.translate(bird.x, bird.y);
      ctx.rotate(bird.rotation * Math.PI / 180);
      ctx.fillStyle = '#ffeb3b';
      ctx.fillRect(-bird.size/2, -bird.size/2, bird.size, bird.size);
      // Ojo
      ctx.fillStyle = 'white';
      ctx.fillRect(bird.size/4, -bird.size/4, bird.size/4, bird.size/4);
      ctx.fillStyle = 'black';
      ctx.fillRect(bird.size/3, -bird.size/5, bird.size/6, bird.size/6);
      // Pico
      ctx.fillStyle = '#ff9800';
      ctx.beginPath();
      ctx.moveTo(bird.size/2, 0);
      ctx.lineTo(bird.size/1.5, -5);
      ctx.lineTo(bird.size/1.5, 5);
      ctx.closePath();
      ctx.fill();
      ctx.restore();

      // Tubos
      if (frame % 90 === 0) spawnPipe();

      for (let i = pipes.length - 1; i >= 0; i--) {
        let p = pipes[i];
        p.x -= 2;

        // Dibujar tubos
        ctx.fillStyle = '#4caf50';
        // Tubo superior
        ctx.fillRect(p.x, 0, 80, p.top);
        ctx.fillRect(p.x - 10, p.top - 40, 100, 40); // tapa
        // Tubo inferior
        ctx.fillRect(p.x, p.bottom, 80, canvas.height);
        ctx.fillRect(p.x - 10, p.bottom, 100, 40); // tapa

        // Colisi贸n
        if (
          bird.x + bird.size/2 > p.x &&
          bird.x - bird.size/2 < p.x + 80 &&
          (bird.y - bird.size/2 < p.top || bird.y + bird.size/2 > p.bottom)
        ) {
          bird.alive = false;
        }

        // Puntuaci贸n
        if (!p.passed && bird.x > p.x + 80) {
          p.passed = true;
          score++;
        }

        // Eliminar tubos fuera de pantalla
        if (p.x < -100) pipes.splice(i, 1);
      }

      // Colisi贸n con suelo o techo
      if (bird.y + bird.size/2 > canvas.height - 50 || bird.y - bird.size/2 < 0) {
        bird.alive = false;
      }

      // Mostrar puntuaci贸n
      ctx.fillStyle = 'white';
      ctx.font = 'bold 60px Arial';
      ctx.textAlign = 'center';
      ctx.fillText(score, canvas.width / 2, 100);

      // Game Over
      if (!bird.alive) {
        document.getElementById('finalScore').textContent = score;
        document.getElementById('gameOverScreen').style.display = 'flex';
        gameStarted = false;

        // Medalla seg煤n puntuaci贸n
        const medal = document.getElementById('medal');
        if (score >= 40) medal.textContent = '';
        else if (score >= 30) medal.textContent = '';
        else if (score >= 20) medal.textContent = '';
        else if (score >= 10) medal.textContent = '';
        else medal.textContent = '';
      }

      frame++;
      if (bird.alive) requestAnimationFrame(gameLoop);
    }

    // Empezar al cargar
    window.onload = () => {
      bird.x = canvas.width / 4;
      bird.size = Math.min(canvas.width, canvas.height) * 0.08;
    };
  </script>
</body>
</html>
